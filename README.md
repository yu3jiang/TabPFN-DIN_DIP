# TabPFN-DIN_DIP
TabPFN-Based Retrieval Model for Water Quality Parameters (DIN/DIP)

## Project Introduction

This repository implements the regression retrieval functionality for Dissolved Inorganic Nitrogen (DIN) and Dissolved Inorganic Phosphorus (DIP) based on the TabPFN model. The code corresponds to the paper "An Interpretable Transformer-Based Framework for Monitoring Dissolved Inorganic Nitrogen and Phosphorus in Jiangsu–Zhejiang–Shanghai Offshore", and includes two core types of scripts for model training and data production, which can be directly used to reproduce the relevant experimental results in the paper.

Core Dependency: TabPFN (Official Repository: https://github.com/PriorLabs/TabPFN)

## File Description

- DIN_train.py: Implements regression training for DIN based on the TabPFN model.

- DIP_train.py: Implements regression training for DIP based on the TabPFN model.

- Production_DIN.py: Loads the pre-trained DIN model weights, performs DIN parameter prediction on input data, and outputs formatted retrieval results.

- Production_DIP.py: Loads the pre-trained DIP model weights, performs DIP parameter prediction on input data, and outputs formatted retrieval results.

## Environment Requirements
**Python Version**: ≥ 3.9

## Dependency Installation
```bash
pip install tabpfn
pip install numpy pandas scikit-learn torch
```

## Products
The DIN and DIP products generated by this model are available via the following link: https://doi.org/10.6084/m9.figshare.30343414

## Citation

Jiang, Y.; Song, Z.; Wang, M.; He, X.; Nie, Q.; Li, Z.; Du, X.; Zhang, X. An Interpretable Transformer-Based Framework for Monitoring Dissolved Inorganic Nitrogen and Phosphorus in Jiangsu–Zhejiang–Shanghai Offshore. Remote Sens., under review.

## License

The code of this project is open-sourced under the Apache 2.0 License, and details can be found in the LICENSE file in the repository.

Usage Notes:

- The license terms of this project follow the requirements of the original TabPFN project. Please carefully read the official TabPFN license before use (https://github.com/PriorLabs/TabPFN/blob/main/LICENSE).

- It is only for academic research and non-commercial use. Commercial use must comply with the license terms of the original TabPFN project and this repository.

## Acknowledgements

We would like to thank the TabPFN development team for providing the basic model support, as well as the technical contributions from the relevant open-source communities. Official TabPFN repository link: https://github.com/PriorLabs/TabPFN.
